<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASS MANUAL: thermodynamics.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASS MANUAL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('thermodynamics_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">thermodynamics.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="thermodynamics_8h_source.html">thermodynamics.h</a>&quot;</code><br />
<code>#include &quot;history.h&quot;</code><br />
<code>#include &quot;hyrectools.h&quot;</code><br />
<code>#include &quot;helium.h&quot;</code><br />
<code>#include &quot;wrap_hyrec.h&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for thermodynamics.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="thermodynamics_8c__incl.png" border="0" usemap="#athermodynamics_8c" alt=""/></div>
<map name="athermodynamics_8c" id="athermodynamics_8c">
<area shape="rect" title=" " alt="" coords="880,5,1008,32"/>
<area shape="rect" href="thermodynamics_8h.html" title=" " alt="" coords="642,80,771,107"/>
<area shape="rect" title=" " alt="" coords="888,155,987,182"/>
<area shape="rect" title=" " alt="" coords="909,80,979,107"/>
<area shape="rect" title=" " alt="" coords="1003,80,1095,107"/>
<area shape="rect" title=" " alt="" coords="1119,80,1190,107"/>
<area shape="rect" href="background_8h.html" title=" " alt="" coords="248,155,347,182"/>
<area shape="rect" href="evolver__ndf15_8h_source.html" title=" " alt="" coords="515,155,629,182"/>
<area shape="rect" href="evolver__rkck_8h_source.html" title=" " alt="" coords="385,155,492,182"/>
<area shape="rect" href="wrap__recfast_8h_source.html" title=" " alt="" coords="653,155,760,182"/>
<area shape="rect" href="injection_8h_source.html" title=" " alt="" coords="784,155,864,182"/>
<area shape="rect" href="common_8h.html" title=" " alt="" coords="447,305,529,332"/>
<area shape="rect" href="quadrature_8h_source.html" title=" " alt="" coords="31,230,124,257"/>
<area shape="rect" title=" " alt="" coords="148,230,239,257"/>
<area shape="rect" href="arrays_8h_source.html" title=" " alt="" coords="263,230,331,257"/>
<area shape="rect" href="dei__rkck_8h_source.html" title=" " alt="" coords="447,230,529,257"/>
<area shape="rect" href="parser_8h_source.html" title=" " alt="" coords="356,230,423,257"/>
<area shape="rect" title=" " alt="" coords="156,380,217,407"/>
<area shape="rect" title=" " alt="" coords="240,380,304,407"/>
<area shape="rect" title=" " alt="" coords="328,380,389,407"/>
<area shape="rect" title=" " alt="" coords="413,380,477,407"/>
<area shape="rect" title=" " alt="" coords="502,380,559,407"/>
<area shape="rect" href="svnversion_8h_source.html" title=" " alt="" coords="583,380,678,407"/>
<area shape="rect" title=" " alt="" coords="702,380,770,407"/>
<area shape="rect" href="precisions_8h_source.html" title=" " alt="" coords="794,380,886,407"/>
<area shape="rect" href="macros__precision_8h_source.html" title=" " alt="" coords="773,455,907,482"/>
<area shape="rect" href="sparse_8h_source.html" title=" " alt="" coords="604,230,676,257"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab8e3a9959673f9e76a2dfd68158fa926"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#ab8e3a9959673f9e76a2dfd68158fa926">thermodynamics_at_z</a> (struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, double z, enum <a class="el" href="background_8h.html#ad9e4243fee7761006cf5e8d3265c7f39">interpolation_method</a> inter_mode, int *last_index, double *pvecback, double *pvecthermo)</td></tr>
<tr class="separator:ab8e3a9959673f9e76a2dfd68158fa926"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3d7a6859b123e49ba5e760c22a69561"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#aa3d7a6859b123e49ba5e760c22a69561">thermodynamics_init</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth)</td></tr>
<tr class="separator:aa3d7a6859b123e49ba5e760c22a69561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3491ac447b26dbbab5ea63596e16c42b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a3491ac447b26dbbab5ea63596e16c42b">thermodynamics_free</a> (struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth)</td></tr>
<tr class="separator:a3491ac447b26dbbab5ea63596e16c42b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96e9a114c97a9f388fe835698e8df877"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a96e9a114c97a9f388fe835698e8df877">thermodynamics_free_input</a> (struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth)</td></tr>
<tr class="separator:a96e9a114c97a9f388fe835698e8df877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0daa5563192f47089298a41c811a41e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#ae0daa5563192f47089298a41c811a41e">thermodynamics_helium_from_bbn</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth)</td></tr>
<tr class="separator:ae0daa5563192f47089298a41c811a41e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97dd82ac490cf26e3fde03b5a684930f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a97dd82ac490cf26e3fde03b5a684930f">thermodynamics_checks</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth)</td></tr>
<tr class="separator:a97dd82ac490cf26e3fde03b5a684930f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e82cccfa81929e60d9485b72059d8e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a8e82cccfa81929e60d9485b72059d8e8">thermodynamics_workspace_init</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *ptw)</td></tr>
<tr class="separator:a8e82cccfa81929e60d9485b72059d8e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dbb0cdbedfbf074aea47ba732b6cb3a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a3dbb0cdbedfbf074aea47ba732b6cb3a">thermodynamics_indices</a> (struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *ptw)</td></tr>
<tr class="separator:a3dbb0cdbedfbf074aea47ba732b6cb3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c5aed784d2b9d51c77fa64fcc8d0fb9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a3c5aed784d2b9d51c77fa64fcc8d0fb9">thermodynamics_lists</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *ptw)</td></tr>
<tr class="separator:a3c5aed784d2b9d51c77fa64fcc8d0fb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a9006a4cddaa15ea2c2448b5ca00421"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a0a9006a4cddaa15ea2c2448b5ca00421">thermodynamics_set_parameters_reionization</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, struct <a class="el" href="thermodynamics_8h.html#structthermo__reionization__parameters">thermo_reionization_parameters</a> *preio)</td></tr>
<tr class="separator:a0a9006a4cddaa15ea2c2448b5ca00421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ddc03df693393b064eb2f7d5a3f3339"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a7ddc03df693393b064eb2f7d5a3f3339">thermodynamics_solve</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *ptw, double *pvecback)</td></tr>
<tr class="separator:a7ddc03df693393b064eb2f7d5a3f3339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d94c5075ae40d692be245f6eaa4a605"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a5d94c5075ae40d692be245f6eaa4a605">thermodynamics_calculate_remaining_quantities</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, double *pvecback)</td></tr>
<tr class="separator:a5d94c5075ae40d692be245f6eaa4a605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b9f39825e10d6561495f8e8888501ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a6b9f39825e10d6561495f8e8888501ab">thermodynamics_output_summary</a> (struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth)</td></tr>
<tr class="separator:a6b9f39825e10d6561495f8e8888501ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49ac7d28868878d69a9a2c64689878b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a49ac7d28868878d69a9a2c64689878b2">thermodynamics_workspace_free</a> (struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *ptw)</td></tr>
<tr class="separator:a49ac7d28868878d69a9a2c64689878b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4626f92aadd14ce442d905afd229a1ba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a4626f92aadd14ce442d905afd229a1ba">thermodynamics_vector_init</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, double mz, struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *ptw)</td></tr>
<tr class="separator:a4626f92aadd14ce442d905afd229a1ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab84ffa439d6b960b41514b1a7bf51a46"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#ab84ffa439d6b960b41514b1a7bf51a46">thermodynamics_reionization_evolve_with_tau</a> (struct <a class="el" href="thermodynamics_8h.html#structthermodynamics__parameters__and__workspace">thermodynamics_parameters_and_workspace</a> *ptpaw, double mz_ini, double mz_end, double *mz_output, int mz_size)</td></tr>
<tr class="separator:ab84ffa439d6b960b41514b1a7bf51a46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1722d15f2f26f143dc349fabe232a8e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a1722d15f2f26f143dc349fabe232a8e6">thermodynamics_derivs</a> (double mz, double *y, double *dy, void *parameters_and_workspace, ErrorMsg error_message)</td></tr>
<tr class="separator:a1722d15f2f26f143dc349fabe232a8e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c88153bbc12144fe79663a27125fc1e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a9c88153bbc12144fe79663a27125fc1e">thermodynamics_timescale</a> (double mz, void *thermo_parameters_and_workspace, double *timescale, ErrorMsg error_message)</td></tr>
<tr class="separator:a9c88153bbc12144fe79663a27125fc1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd2459d533bf41d6bdedde716ecb564e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#abd2459d533bf41d6bdedde716ecb564e">thermodynamics_sources</a> (double mz, double *y, double *dy, int index_z, void *thermo_parameters_and_workspace, ErrorMsg error_message)</td></tr>
<tr class="separator:abd2459d533bf41d6bdedde716ecb564e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adecb16a8429fa3966c3512ce1df85e09"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#adecb16a8429fa3966c3512ce1df85e09">thermodynamics_reionization_get_tau</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *ptw)</td></tr>
<tr class="separator:adecb16a8429fa3966c3512ce1df85e09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ddf14da0391b9d23c4abbc3cfbf6158"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a5ddf14da0391b9d23c4abbc3cfbf6158">thermodynamics_vector_free</a> (struct <a class="el" href="thermodynamics_8h.html#structthermo__vector">thermo_vector</a> *tv)</td></tr>
<tr class="separator:a5ddf14da0391b9d23c4abbc3cfbf6158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fbb09966f8aa2b9f69ba06f663feff9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a9fbb09966f8aa2b9f69ba06f663feff9">thermodynamics_calculate_conformal_drag_time</a> (struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, double *pvecback)</td></tr>
<tr class="separator:a9fbb09966f8aa2b9f69ba06f663feff9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af930b9a57a16029b016f88f360d4dbd7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#af930b9a57a16029b016f88f360d4dbd7">thermodynamics_calculate_damping_scale</a> (struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, double *pvecback)</td></tr>
<tr class="separator:af930b9a57a16029b016f88f360d4dbd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc9c4eec0fc1862a520c1ca66cd59d54"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#afc9c4eec0fc1862a520c1ca66cd59d54">thermodynamics_calculate_opticals</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth)</td></tr>
<tr class="separator:afc9c4eec0fc1862a520c1ca66cd59d54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c888f7fb878b1931ce1f4a9ffc51ce3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a2c888f7fb878b1931ce1f4a9ffc51ce3">thermodynamics_calculate_idm_and_idr_quantities</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, double *pvecback)</td></tr>
<tr class="separator:a2c888f7fb878b1931ce1f4a9ffc51ce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f008ecbc07cec5d7cd8cdf4fa26ff47"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a3f008ecbc07cec5d7cd8cdf4fa26ff47">thermodynamics_calculate_recombination_quantities</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, double *pvecback)</td></tr>
<tr class="separator:a3f008ecbc07cec5d7cd8cdf4fa26ff47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53465e7fdf8a36c0905ff909d12aadd7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a53465e7fdf8a36c0905ff909d12aadd7">thermodynamics_calculate_drag_quantities</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, double *pvecback)</td></tr>
<tr class="separator:a53465e7fdf8a36c0905ff909d12aadd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb4a2cb09339ac0068c732bb56672bfb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#afb4a2cb09339ac0068c732bb56672bfb">thermodynamics_ionization_fractions</a> (double z, double *y, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *ptw, int current_ap)</td></tr>
<tr class="separator:afb4a2cb09339ac0068c732bb56672bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7cede4f50dd5d833a11be70890ae07d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#ae7cede4f50dd5d833a11be70890ae07d">thermodynamics_reionization_function</a> (double z, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, struct <a class="el" href="thermodynamics_8h.html#structthermo__reionization__parameters">thermo_reionization_parameters</a> *preio, double *x)</td></tr>
<tr class="separator:ae7cede4f50dd5d833a11be70890ae07d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b34f6155bde89a84c0390c2fc61f8ea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a4b34f6155bde89a84c0390c2fc61f8ea">thermodynamics_output_titles</a> (struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, char titles[_MAXTITLESTRINGLENGTH_])</td></tr>
<tr class="separator:a4b34f6155bde89a84c0390c2fc61f8ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76d7488aed4246518d57574d8b6da687"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a76d7488aed4246518d57574d8b6da687">thermodynamics_output_data</a> (struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, int number_of_titles, double *data)</td></tr>
<tr class="separator:a76d7488aed4246518d57574d8b6da687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a593f1de8b76eec15471b9a9622979a14"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#a593f1de8b76eec15471b9a9622979a14">thermodynamics_idm_quantities</a> (struct <a class="el" href="structbackground.html">background</a> *pba, double z, double *y, double *dy, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *ptw, double *pvecback)</td></tr>
<tr class="separator:a593f1de8b76eec15471b9a9622979a14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad37daacbb0770350d2de9ef09e8732bc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#ad37daacbb0770350d2de9ef09e8732bc">thermodynamics_obtain_z_ini</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *ptw)</td></tr>
<tr class="separator:ad37daacbb0770350d2de9ef09e8732bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc44fb1fee6d4f38add0ec049664b4b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thermodynamics_8c.html#aacc44fb1fee6d4f38add0ec049664b4b">thermodynamics_idm_initial_temperature</a> (struct <a class="el" href="structbackground.html">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, double z_ini, struct <a class="el" href="thermodynamics_8h.html#structthermo__diffeq__workspace">thermo_diffeq_workspace</a> *ptdw)</td></tr>
<tr class="separator:aacc44fb1fee6d4f38add0ec049664b4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Documented thermodynamics module</p>
<ul>
<li>Julien Lesgourgues, 6.09.2010</li>
<li>Restructured by Nils Schoeneberg and Matteo Lucca, 27.02.2019</li>
<li>Evolver implementation by Daniel Meinert, spring 2019</li>
</ul>
<p>Deals with the thermodynamical evolution. This module has two purposes:</p>
<ul>
<li>at the beginning, to initialize the thermodynamics, i.e. to integrate the thermodynamical equations, and store all thermodynamical quantities as a function of redshift inside an interpolation table.</li>
<li>to provide a routine which allow other modules to evaluate any thermodynamical quantities at a given redshift value (by interpolating within the interpolation table).</li>
</ul>
<p>The most important differential equations to compute the free electron fraction x at each step are provided either by the HyRec 2020 or RecFastCLASS code, located in the external/ directory. The thermodynamics module integrates these equations using the generic integrator (which can be set to ndf15, rkck4, etc.) The HyRec and RecFastCLASS algorithms are used and called in the same way by this module.</p>
<p>In summary, the following functions can be called from other modules:</p>
<ol type="1">
<li>thermodynamics_init at the beginning (but after background_init)</li>
<li>thermodynamics_at_z at any later time</li>
<li>thermodynamics_free at the end, when no more calls to thermodynamics_at_z are needed </li>
</ol>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab8e3a9959673f9e76a2dfd68158fa926"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8e3a9959673f9e76a2dfd68158fa926">&#9670;&nbsp;</a></span>thermodynamics_at_z()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_at_z </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="background_8h.html#ad9e4243fee7761006cf5e8d3265c7f39">interpolation_method</a>&#160;</td>
          <td class="paramname"><em>inter_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>last_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pvecback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pvecthermo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Thermodynamics quantities at given redshift z. Evaluates all thermodynamics quantities at a given value of the redshift by reading the pre-computed table and interpolating.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to the thermodynamics structure (containing pre-computed table) </td></tr>
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">inter_mode</td><td>Input: interpolation mode (normal or growing_closeby) </td></tr>
    <tr><td class="paramname">last_index</td><td>Input/Output: index of the previous/current point in the interpolation array (input only for closeby mode, output for both) </td></tr>
    <tr><td class="paramname">pvecback</td><td>Input: vector of background quantities (used only in case z&gt;z_initial for getting ddkappa and dddkappa; in that case, should be already allocated (!) and filled (!), with format short_info or larger; in other cases, will be ignored) </td></tr>
    <tr><td class="paramname">pvecthermo</td><td>Output: vector of thermodynamics quantities (assumed to be already allocated) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>interpolate in table with array_interpolate_spline (normal mode) or array_interpolate_spline_growing_closeby (closeby mode)</li>
</ul>

</div>
</div>
<a id="aa3d7a6859b123e49ba5e760c22a69561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3d7a6859b123e49ba5e760c22a69561">&#9670;&nbsp;</a></span>thermodynamics_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the thermodynamics structure, and in particular the thermodynamics interpolation table.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to initialized thermodynamics structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>update the user about which recombination code is being run</li>
<li>set flag for varying constants</li>
<li>compute and check primordial Helium mass fraction rho_He/(rho_H+rho_He)</li>
<li>infer primordial helium-to-hydrogen nucleon ratio n_He/n_H It is calculated via n_He/n_H = rho_He/(m_He/m_H * rho_H) = YHe * rho_b / (m_He/m_H * (1-YHe) rho_b) = YHe / (m_He/m_H * (1-YHe))</li>
<li>infer number of hydrogen nuclei today in m**-3</li>
<li>test whether all parameters are in the correct regime</li>
<li>allocate and assign all temporary structures and indices</li>
<li>initialize injection struct (not temporary)</li>
<li>assign reionisation parameters</li>
<li>solve recombination and reionization and store values of <img class="formulaInl" alt="$ z, x_e, d \kappa / d \tau, T_b, c_b^2 $" src="form_294.png"/> <br  />
</li>
<li>the differential equation system is now completely solved <br  />
</li>
<li>fill missing columns (quantities not computed during the differential evolution but related)</li>
<li>write information on thermal history in standard output</li>
<li>free workspace and local variables</li>
</ul>

</div>
</div>
<a id="a3491ac447b26dbbab5ea63596e16c42b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3491ac447b26dbbab5ea63596e16c42b">&#9670;&nbsp;</a></span>thermodynamics_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all memory space allocated by thermodynamics_init.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to thermodynamics structure (to be freed) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a96e9a114c97a9f388fe835698e8df877"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96e9a114c97a9f388fe835698e8df877">&#9670;&nbsp;</a></span>thermodynamics_free_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_free_input </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all memory space allocated by <a class="el" href="input_8c.html">input.c</a> for the thermodynamics module.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to thermodynamics structure (to be freed) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>8.d) reionization parameters if reio_parametrization=reio_many_tanh</p>

</div>
</div>
<a id="ae0daa5563192f47089298a41c811a41e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0daa5563192f47089298a41c811a41e">&#9670;&nbsp;</a></span>thermodynamics_helium_from_bbn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_helium_from_bbn </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Infer the primordial helium mass fraction from standard BBN calculations, as a function of the baryon density and expansion rate during BBN.</p>
<p>This module is simpler then the one used in arXiv:0712.2826 because it neglects the impact of a possible significant chemical potentials for electron neutrinos. The full code with xi_nu_e could be introduced here later.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to initialized thermodynamics structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>
<ul>
<li>Infer effective number of neutrinos at the time of BBN</li>
<li>We randomly choose 0.1 MeV to be the temperature of BBN</li>
<li>compute Delta N_eff as defined in bbn file, i.e. <img class="formulaInl" alt="$ \Delta N_{eff}=0$" src="form_295.png"/> means <img class="formulaInl" alt="$ N_{eff}=3.046$" src="form_296.png"/>. Note that even if 3.044 is a better default value, we must keep 3.046 here as long as the BBN file we are using has been computed assuming 3.046.</li>
<li>spline in one dimension (along deltaN)</li>
<li>interpolate in one dimension (along deltaN)</li>
<li>spline in remaining dimension (along omegab)</li>
<li>interpolate in remaining dimension (along omegab)</li>
<li>Take into account impact of varying alpha on helium fraction</li>
<li>deallocate arrays</li>
</ul>

</div>
</div>
<a id="a97dd82ac490cf26e3fde03b5a684930f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97dd82ac490cf26e3fde03b5a684930f">&#9670;&nbsp;</a></span>thermodynamics_checks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_checks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check the thermodynamics structure parameters for bounds and critical values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to initialized thermodynamics structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>check BBN Y_He fracion</li>
<li>tests in order to prevent divisions by zero</li>
<li>test initial condition for recombination</li>
</ul>

</div>
</div>
<a id="a8e82cccfa81929e60d9485b72059d8e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e82cccfa81929e60d9485b72059d8e8">&#9670;&nbsp;</a></span>thermodynamics_workspace_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_workspace_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the thermodynamics workspace.</p>
<p>The workspace contains the arrays used for solving differential equations (dubbed <a class="el" href="thermodynamics_8h.html#structthermo__diffeq__workspace">thermo_diffeq_workspace</a>), and storing all approximations, reionization parameters, heating parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to the thermodynamics structure </td></tr>
    <tr><td class="paramname">ptw</td><td>Input/Output: pointer to thermodynamics workspace </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>
<ul>
<li>number of z values</li>
<li>relevant cosmological parameters</li>
<li>relevant constants</li>
<li>Allocate and initialize differential equation workspace</li>
<li>define approximations</li>
<li>store all ending redshifts for each approximation</li>
<li>Rescale these redshifts in case of varying fundamental constants</li>
<li>store smoothing deltas for transitions at the beginning of each aproximation</li>
<li>Allocate reionisation parameter workspace</li>
</ul>

</div>
</div>
<a id="a3dbb0cdbedfbf074aea47ba732b6cb3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dbb0cdbedfbf074aea47ba732b6cb3a">&#9670;&nbsp;</a></span>thermodynamics_indices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_indices </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assign value to each relevant index in vectors of thermodynamical quantities, and the reionization parameters</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to thermodynamics structure </td></tr>
    <tr><td class="paramname">ptw</td><td>Input/Output: pointer to thermo workspace </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>initialization of all indices and flags in thermodynamics structure</li>
<li>initialization of all indices of parameters of reionization function</li>
</ul>

</div>
</div>
<a id="a3c5aed784d2b9d51c77fa64fcc8d0fb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c5aed784d2b9d51c77fa64fcc8d0fb9">&#9670;&nbsp;</a></span>thermodynamics_lists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_lists </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the lists (of redshift, tau, etc.) of the thermodynamics struct</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to thermodynamics structure </td></tr>
    <tr><td class="paramname">ptw</td><td>Input: pointer to thermo workspace </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>
<ul>
<li>allocate tables</li>
<li>define time sampling</li>
<li>store initial value of conformal time in the structure</li>
</ul>

</div>
</div>
<a id="a0a9006a4cddaa15ea2c2448b5ca00421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a9006a4cddaa15ea2c2448b5ca00421">&#9670;&nbsp;</a></span>thermodynamics_set_parameters_reionization()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_set_parameters_reionization </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__reionization__parameters">thermo_reionization_parameters</a> *&#160;</td>
          <td class="paramname"><em>preio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine initializes reionization_parameters for the chosen scheme of reionization function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to the thermodynamics structure </td></tr>
    <tr><td class="paramname">preio</td><td>Input/Output: pointer to the reionization parameters structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>
<ul>
<li>allocate the vector of parameters defining the function <img class="formulaInl" alt="$ X_e(z) $" src="form_297.png"/></li>
<li>(a) no reionization</li>
<li>(b) if reionization implemented like in CAMB, or half tanh like in 1209.0247</li>
<li>--&gt; set values of these parameters, excepted those depending on the reionization redshift</li>
<li>--&gt; if reionization redshift given as an input, initialize the remaining values</li>
<li>--&gt; if reionization optical depth given as an input, find reionization redshift by bisection and initialize the remaining values</li>
<li>(c) if reionization implemented with reio_bins_tanh scheme</li>
<li>(d) if reionization implemented with reio_many_tanh scheme</li>
<li>(e) if reionization implemented with reio_inter scheme</li>
</ul>

</div>
</div>
<a id="a7ddc03df693393b064eb2f7d5a3f3339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ddc03df693393b064eb2f7d5a3f3339">&#9670;&nbsp;</a></span>thermodynamics_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_solve </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pvecback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Integrate thermodynamics with your favorite recombination code. The default options are HyRec and RecFastCLASS.</p>
<p>Integrate thermodynamics with HyRec or Recfast, allocate and fill part of the thermodynamics interpolation table (the rest is filled in thermodynamics_calculate_remaining_quantitie).</p>
<p>Version modified by Daniel Meinert and Nils Schoeneberg to use the ndf15 evolver or any other evolver inherent to CLASS, modified again by Nils Schoeneberg to use wrappers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to thermodynamics structure where results are stored </td></tr>
    <tr><td class="paramname">ptw</td><td>Input: pointer to <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> structure used to communicate with generic evolver </td></tr>
    <tr><td class="paramname">pvecback</td><td>Input: pointer to an allocated (but empty) vector of background variables </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status</dd></dl>
<p>Integrate thermodynamics with your favorite recombination code. The default options are HyRec and Recfast. </p>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>choose evolver</li>
<li>define the fields of the 'thermodynamics parameter and workspace' structure</li>
<li>define time sampling: create a local array of minus z values called mz (from mz=-zinitial growing towards mz=0)</li>
<li>define intervals for each approximation scheme</li>
<li>loop over intervals over which approximation scheme is uniform. For each interval:</li>
<li>--&gt; (a) fix current approximation scheme.</li>
<li>--&gt; (b) define the vector of quantities to be integrated over. If the current interval starts from the initial time zinitial, fill the vector with initial conditions. If it starts from an approximation switching point, redistribute correctly the values from the previous to the new vector. For both RECFAST and HYREC, the vector consists of Tmat, x_H, x_He, + others for exotic models</li>
<li>--&gt; (c1) If we have the optical depth tau_reio as input the last evolver step (reionization approximation) is done separately in a loop, to find the approximate redshift of reionization given the input of tau_reio, using a bisection method. This is similar to the general CLASS shooting method, but doing this step here is more advantageous since we only need to do repeatedly the last approximation step of the integration, instead of the full background and thermodynamics module</li>
</ul>
<p>--&gt; (c2) otherwise, just integrate quantities over the current interval.</p>
<ul>
<li>Compute reionization optical depth, if not supplied as input parameter</li>
<li>free quantities allocated at the beginning of the routine</li>
</ul>

</div>
</div>
<a id="a5d94c5075ae40d692be245f6eaa4a605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d94c5075ae40d692be245f6eaa4a605">&#9670;&nbsp;</a></span>thermodynamics_calculate_remaining_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_calculate_remaining_quantities </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pvecback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate those thermodynamics quantities which are not inside of the thermodynamics table already.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to initialized thermodynamics structure </td></tr>
    <tr><td class="paramname">pvecback</td><td>Input: pointer to some allocated pvecback </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>fill tables of second derivatives with respect to z (in view of spline interpolation)</li>
</ul>

</div>
</div>
<a id="a6b9f39825e10d6561495f8e8888501ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b9f39825e10d6561495f8e8888501ab">&#9670;&nbsp;</a></span>thermodynamics_output_summary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_output_summary </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>In verbose mode, print basic information on the thermal history</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to initialized thermodynamics structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>

</div>
</div>
<a id="a49ac7d28868878d69a9a2c64689878b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49ac7d28868878d69a9a2c64689878b2">&#9670;&nbsp;</a></span>thermodynamics_workspace_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_workspace_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free the <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> structure (with the exception of the <a class="el" href="thermodynamics_8h.html#structthermo__vector">thermo_vector</a> '-&gt;ptv' field, which is freed separately in thermo_vector_free).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pth</td><td>Input: pointer to initialized thermodynamics structure </td></tr>
    <tr><td class="paramname">ptw</td><td>Input: pointer to <a class="el" href="perturbations_8h.html#structperturbations__workspace">perturbations_workspace</a> structure to be freed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a4626f92aadd14ce442d905afd229a1ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4626f92aadd14ce442d905afd229a1ba">&#9670;&nbsp;</a></span>thermodynamics_vector_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_vector_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the field '-&gt;ptv' of a <a class="el" href="thermodynamics_8h.html#structthermo__diffeq__workspace">thermo_diffeq_workspace</a> structure, which is a <a class="el" href="thermodynamics_8h.html#structthermo__vector">thermo_vector</a> structure. This structure contains indices and values of all quantities which need to be integrated with respect to time (and only them: quantities fixed analytically or obeying constraint equations are NOT included in this vector).</p>
<p>The routine sets and allocates the vector y, dy and used_in_output with the right size depending on the current approximation scheme stored in the workspace. Moreover the initial conditions for each approximation scheme are calculated and set correctly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to the thermodynamics structure </td></tr>
    <tr><td class="paramname">mz</td><td>Input: negative redshift </td></tr>
    <tr><td class="paramname">ptw</td><td>Input/Output: pointer to thermodynamics workspace</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>

</div>
</div>
<a id="ab84ffa439d6b960b41514b1a7bf51a46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab84ffa439d6b960b41514b1a7bf51a46">&#9670;&nbsp;</a></span>thermodynamics_reionization_evolve_with_tau()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_reionization_evolve_with_tau </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics__parameters__and__workspace">thermodynamics_parameters_and_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptpaw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mz_ini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mz_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mz_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mz_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If the input for reionization is tau_reio, <a class="el" href="thermodynamics_8c.html#a7ddc03df693393b064eb2f7d5a3f3339">thermodynamics_solve()</a> calls this function instead of the evolver for dealing with the last era (the reionization era).</p>
<p>Instead of computing the evolution of quantities during reionization for a fixed z_reio, as the evolver would do, this function finds z_reio by bisection. First we make an initial guess for z_reio with reionization_z_start_max and then find a z_reio which leads to the given tau_reio (in the range of tolerance reionization_optical_depth_tol).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptpaw</td><td>Input: pointer to parameters and workspace </td></tr>
    <tr><td class="paramname">mz_ini</td><td>Input: initial redshift </td></tr>
    <tr><td class="paramname">mz_end</td><td>Input: ending redshift </td></tr>
    <tr><td class="paramname">mz_output</td><td>Input: pointer to redshift array at which output should be written </td></tr>
    <tr><td class="paramname">mz_size</td><td>Input: number of redshift values in this array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>
<ul>
<li>Remame fields to avoid heavy notations</li>
<li>Choose evolver</li>
<li>ptvs will be a pointer towards the same thermo vector that was used in the previous approximation schemes; it contains values that will serve here to set initial conditions.</li>
<li>ptv is a pointer towards a whole new thermo vector used for the calculations in the bisection, that we must allocate and initialize</li>
<li>Initialize the values of the temporary vector</li>
<li>Evolve quantities through reionization assuming upper value of z_reio</li>
<li>Restore initial conditions</li>
<li>Evolve quantities through reionization assuming lower value of z_reio</li>
<li>Restore initial conditions</li>
<li>Evolve quantities through reionization, trying intermediate values of z_reio by bisection</li>
<li>Store the ionization redshift in the thermodynamics structure</li>
<li>Free tempeoraty thermo vector</li>
</ul>

</div>
</div>
<a id="a1722d15f2f26f143dc349fabe232a8e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1722d15f2f26f143dc349fabe232a8e6">&#9670;&nbsp;</a></span>thermodynamics_derivs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_derivs </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>parameters_and_workspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ErrorMsg&#160;</td>
          <td class="paramname"><em>error_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subroutine evaluating the derivative of thermodynamical quantities with respect to negative redshift mz=-z.</p>
<p>Automatically recognizes the current approximation interval and computes the derivatives for this interval of the vector y, which contains (Tmat, x_H, x_He) + others for exotic models.</p>
<p>Derivatives are obtained either by calling either HyRec 2020 (Lee and Ali-Haimoud 2020, 2007.14114) or RecFastCLASS (that is, RecFast version 1.5, modified by Daniel Meinert and Nils Schoeneberg for better precision and smoothness at early times). See credits and licences in the wrappers (in external/...)</p>
<p>This is one of the few functions in the code which are passed to the generic_evolver routine. Since generic_evolver should work with functions passed from various modules, the format of the arguments is a bit special:</p>
<ul>
<li>fixed parameters and workspaces are passed through a generic pointer. Here, this pointer contains the precision, background and thermodynamics structures, plus a background vector, but generic_evolver doesn't know its precise structure.</li>
<li>the error management is a bit special: errors are not written as usual to pth-&gt;error_message, but to a generic error_message passed in the list of arguments.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mz</td><td>Input: negative redshift mz = -z </td></tr>
    <tr><td class="paramname">y</td><td>Input: vector of variable to integrate </td></tr>
    <tr><td class="paramname">dy</td><td>Output: its derivative (already allocated) </td></tr>
    <tr><td class="paramname">parameters_and_workspace</td><td>Input: pointer to fixed parameters (e.g. indices) and workspace (already allocated) </td></tr>
    <tr><td class="paramname">error_message</td><td>Output: error message </td></tr>
  </table>
  </dd>
</dl>
<p>Summary:</p>
<p>Define local variables</p>
<ul>
<li>Rename structure fields (just to avoid heavy notations)</li>
<li>Get background/thermo quantities in this point</li>
</ul>
<p>Set Tmat from the evolver (it is always evolved) and store it in the workspace.</p>
<ul>
<li>The input vector y contains thermodynamic variables like (Tmat, x_H,x_He). The goal of this function is: 1) Depending on the chosen code and current approximation, to use either analytical approximations or the vector y to calculate x_e; 2) To compute re-ionization effects on x_e; The output of this function is stored in the workspace ptdw</li>
<li>If needed, calculate heating effects (i.e. any possible energy deposition rates affecting the evolution equations for x and Tmat)</li>
<li>Derivative of the ionization fractions</li>
</ul>
<p>--&gt; use Recfast or HyRec to get the derivatives d(x_H)/dz and d(x_He)/dz, and store the result directly in the vector dy. This gives the derivative of the ionization fractions from recombination only (not from reionization). Of course, the full treatment would involve the actual evolution equations for x_H and x_He during reionization, but these are not yet fully implemented.</p>
<p>&lt; Pass value of fsR = relative alpha (fine-structure)</p>
<p>&lt; Pass value of meR = relative m_e (effective eletron mass)</p>
<ul>
<li>Derivative of the matter temperature (relevant for both Recfast and HyRec cases)</li>
<li>Calculate quantities for interacting dark matter</li>
<li>Derivative of the Dark Matter temperature</li>
<li>If we have extreme heatings, recombination does not fully happen and/or re-ionization happens before a redshift of reionization_z_start_max (default = 50). We want to catch this unphysical regime, because it would lead to further errors (and/or unphysical calculations) within our recombination codes</li>
<li>invert all derivatives (because the evolver evolves with -z, not with +z)</li>
</ul>

</div>
</div>
<a id="a9c88153bbc12144fe79663a27125fc1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c88153bbc12144fe79663a27125fc1e">&#9670;&nbsp;</a></span>thermodynamics_timescale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_timescale </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>thermo_parameters_and_workspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>timescale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ErrorMsg&#160;</td>
          <td class="paramname"><em>error_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is relevant for the rk evolver, not ndf15. It estimates a timescale 'delta z' over which quantitites vary. The rk evolver divides large intervals in steps given by this timescale multiplied by ppr-&gt;thermo_integration_stepsize.</p>
<p>This is one of the few functions in the code which is passed to the generic_evolver routine. Since generic_evolver should work with functions passed from various modules, the format of the arguments is a bit special:</p>
<ul>
<li>fixed parameters and workspaces are passed through a generic pointer. generic_evolver doesn't know the content of this pointer.</li>
<li>the error management is a bit special: errors are not written as usual to pth-&gt;error_message, but to a generic error_message passed in the list of arguments.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mz</td><td>Input: minus the redshift </td></tr>
    <tr><td class="paramname">thermo_parameters_and_workspace</td><td>Input: pointer to parameters and workspace </td></tr>
    <tr><td class="paramname">timescale</td><td>Output: pointer to the timescale </td></tr>
    <tr><td class="paramname">error_message</td><td>Output: possible errors are written here </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="abd2459d533bf41d6bdedde716ecb564e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd2459d533bf41d6bdedde716ecb564e">&#9670;&nbsp;</a></span>thermodynamics_sources()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_sources </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>thermo_parameters_and_workspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ErrorMsg&#160;</td>
          <td class="paramname"><em>error_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is passed to the generic evolver and is called whenever we want to store values for a given mz.</p>
<p>The ionization fraction is either computed within a call to <a class="el" href="thermodynamics_8c.html#a1722d15f2f26f143dc349fabe232a8e6">thermodynamics_derivs()</a>. Moreover there is an automatic smoothing enabled which smoothes out the the ionization_fraction after each approximation switch. This is also the place where HyRec is asked to evolve x(z) using its internal system of differential equations over the next range [z_i, z_i+1], and to store the result in a temporary table.</p>
<p>This is one of the few functions in the code which is passed to the generic_evolver routine. Since generic_evolver should work with functions passed from various modules, the format of the arguments is a bit special:</p>
<ul>
<li>fixed parameters and workspaces are passed through a generic pointer. generic_evolver doesn't know the content of this pointer.</li>
<li>the error management is a bit special: errors are not written as usual to pth-&gt;error_message, but to a generic error_message passed in the list of arguments.</li>
</ul>
<p>All quantities are computed by a simple call to thermodynamics_derivs, which computes all necessary quantities and stores them in the ptdw <a class="el" href="thermodynamics_8h.html#structthermo__diffeq__workspace">thermo_diffeq_workspace</a> structure</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mz</td><td>Input: negative redshift, belonging to array mz_output </td></tr>
    <tr><td class="paramname">y</td><td>Input: vector of evolved thermodynamical quantities </td></tr>
    <tr><td class="paramname">dy</td><td>Input: derivatives of this vector w.r.t redshift </td></tr>
    <tr><td class="paramname">index_z</td><td>Input: index in the array mz_output </td></tr>
    <tr><td class="paramname">thermo_parameters_and_workspace</td><td>Input/Output: in input, all parameters needed by thermodynamics_derivs; in output, recombination table </td></tr>
    <tr><td class="paramname">error_message</td><td>Output: error message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>
<ul>
<li>Rename structure fields (just to avoid heavy notations)</li>
<li>Recalculate all quantities at this current redshift: we need at least pvecback, ptdw-&gt;x_reio, dy[ptv-&gt;index_ti_D_Tmat]</li>
<li>In the recfast case, we manually smooth the results a bit</li>
<li>Store the results in the table. Results are obtained in order of decreasing z, and stored in order of growing z</li>
</ul>

</div>
</div>
<a id="adecb16a8429fa3966c3512ce1df85e09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adecb16a8429fa3966c3512ce1df85e09">&#9670;&nbsp;</a></span>thermodynamics_reionization_get_tau()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_reionization_get_tau </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the optical depth of reionization tau_reio for a given thermodynamical history.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to the thermodynamics structure </td></tr>
    <tr><td class="paramname">ptw</td><td>Input: pointer to thermodynamics workspace </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>
<p>We are searching now for the start of reionization. This will be the time at which the optical depth tau_reio will be computed.</p>
<p>Note that the value reionization_parameters[index_reio_start] is only the start of the reionization function added manually, but not necessarily the total start of reionization. Reionization could be longer/shifted by energy injection.</p>
<p>The actual the definition of tau_reio is not unique and unambiguous. We defined it here to be the optical depth up to the time at which there is a global minimum in the free electron fraction. We search for this time by iterating over the thermodynamics table, in order to find the corresponding index_reio_start.</p>
<ul>
<li>--&gt; spline <img class="formulaInl" alt="$ d \tau / dz $" src="form_298.png"/> with respect to z in view of integrating for optical depth between 0 and the just found starting index</li>
<li>--&gt; integrate for optical depth</li>
</ul>

</div>
</div>
<a id="a5ddf14da0391b9d23c4abbc3cfbf6158"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ddf14da0391b9d23c4abbc3cfbf6158">&#9670;&nbsp;</a></span>thermodynamics_vector_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_vector_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__vector">thermo_vector</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free the <a class="el" href="thermodynamics_8h.html#structthermo__vector">thermo_vector</a> structure, which is the '-&gt;ptv' field of the thermodynamics_differential_workspace ptdw structure</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>Input: pointer to <a class="el" href="thermodynamics_8h.html#structthermo__vector">thermo_vector</a> structure to be freed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a9fbb09966f8aa2b9f69ba06f663feff9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fbb09966f8aa2b9f69ba06f663feff9">&#9670;&nbsp;</a></span>thermodynamics_calculate_conformal_drag_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_calculate_conformal_drag_time </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pvecback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the baryon drag conformal time tau_d = [int_{tau_today}^{tau} dtau -dkappa_d/dtau]</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to initialized thermodynamics structure </td></tr>
    <tr><td class="paramname">pvecback</td><td>Input: Initialized vector of background quantities </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>
<ul>
<li>compute minus the baryon drag interaction rate time, -dkappa_d/dtau = -[1/R * kappa'], with R = 3 rho_b / 4 rho_gamma, stored temporarily in column ddkappa</li>
<li>compute second derivative of this rate, -[1/R * kappa']'', stored temporarily in column dddkappa</li>
<li>compute tau_d = [int_{tau_today}^{tau} dtau -dkappa_d/dtau]</li>
</ul>

</div>
</div>
<a id="af930b9a57a16029b016f88f360d4dbd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af930b9a57a16029b016f88f360d4dbd7">&#9670;&nbsp;</a></span>thermodynamics_calculate_damping_scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_calculate_damping_scale </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pvecback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the damping scale r_d = 2pi/k_d = 2pi * [int_{tau_ini}^{tau} dtau (1/kappa') 1/6 (R^2+16/15(1+R))/(1+R)^2]^1/2 = 2pi * [int_{tau_ini}^{tau} dtau (1/kappa') 1/6 (R^2/(1+R)+16/15)/(1+R)]^1/2</p>
<p>which is like in CosmoTherm (CT), but slightly different from Wayne Hu (WH)'s thesis eq. (5.59): The factor 16/15 in CT is 4/5 in WH, but 16/15 is taking more effects into account</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to initialized thermodynamics structure </td></tr>
    <tr><td class="paramname">pvecback</td><td>Input: Initialized vector of background quantities </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>

</div>
</div>
<a id="afc9c4eec0fc1862a520c1ca66cd59d54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc9c4eec0fc1862a520c1ca66cd59d54">&#9670;&nbsp;</a></span>thermodynamics_calculate_opticals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_calculate_opticals </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate quantities relating to optical phenomena like kappa' and exp(-kappa) and the visibility function, optical depth (including dark matter photon interactions if necessary)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to thermodynamics structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local quantities</p>
<ul>
<li>--&gt; second derivative with respect to tau of dkappa (in view of of spline interpolation)</li>
<li>--&gt; first derivative with respect to tau of dkappa (using spline interpolation)</li>
<li>--&gt; compute -kappa = [int_{tau_today}^{tau} dtau dkappa/dtau], store temporarily in column "g"</li>
</ul>
<p>if there is idm_g, calculate its optical contributions</p>
<ul>
<li>--&gt; second derivative with respect to tau of dmu (in view of of spline interpolation)</li>
<li>--&gt; first derivative with respect to tau of dmu (using spline interpolation)</li>
<li>--&gt; compute -mu = [int_{tau_today}^{tau} dtau dmu/dtau], store temporarily in column "exp_mu_idm_g"</li>
<li>--&gt; compute visibility: <img class="formulaInl" alt="$ g= (d \kappa/d \tau) e^{- \kappa} $" src="form_299.png"/></li>
<li>&mdash;&gt; compute g</li>
<li>&mdash;&gt; compute g' (the plus sign of the second term is correct, see def of -kappa in thermodynamics module!)</li>
<li>&mdash;&gt; compute g'' <br  />
</li>
<li>&mdash;&gt; store g</li>
<li>&mdash;&gt; compute variation rate</li>
<li>smooth the rate (details of smoothing unimportant: only the order of magnitude of the rate matters)</li>
<li>--&gt; derivatives of baryon sound speed (only computed if some non-minimal tight-coupling schemes is requested)</li>
<li>&mdash;&gt; second derivative with respect to tau of cb2</li>
<li>&mdash;&gt; first derivative with respect to tau of cb2 (using spline interpolation)</li>
</ul>

</div>
</div>
<a id="a2c888f7fb878b1931ce1f4a9ffc51ce3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c888f7fb878b1931ce1f4a9ffc51ce3">&#9670;&nbsp;</a></span>thermodynamics_calculate_idm_and_idr_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_calculate_idm_and_idr_quantities </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pvecback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate dark optical depths, idm_b interation rate, and other quantities relevant for idm and idr.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to initialized thermo structure </td></tr>
    <tr><td class="paramname">pvecback</td><td>Input: Initialized vector of background quantities</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>Define local variables</li>
<li>Calculate optical functions tau_idm_dr, tau_idr, g_idm_dr</li>
<li>Find interacting dark radiation free-streaming time</li>
<li>Search after the above free-streaming time for idr free-streaming as well</li>
<li>--&gt; second derivative with respect to tau of R_idm_b (in view of spline interpolation)</li>
<li>--&gt; first derivative with respect to tau of R_idm_b (using spline interpolation)</li>
</ul>

</div>
</div>
<a id="a3f008ecbc07cec5d7cd8cdf4fa26ff47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f008ecbc07cec5d7cd8cdf4fa26ff47">&#9670;&nbsp;</a></span>thermodynamics_calculate_recombination_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_calculate_recombination_quantities </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pvecback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate various quantities at the time of recombination, as well as the time tau_cut at which visibility gets negligible and one can assume pure free-streaming.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to initialized thermodynamics structure </td></tr>
    <tr><td class="paramname">pvecback</td><td>Input: pointer to some allocated pvecback </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>
<ul>
<li>find maximum of g</li>
<li>find conformal recombination time using background_tau_of_z</li>
<li>find damping scale at recombination (using linear interpolation)</li>
<li>find time (always after recombination) at which tau_c/tau falls below some threshold, defining tau_free_streaming</li>
<li>find time above which visibility falls below a given fraction of its maximum</li>
<li>find z_star (when optical depth kappa crosses one, using linear interpolation) and sound horizon at that time</li>
</ul>

</div>
</div>
<a id="a53465e7fdf8a36c0905ff909d12aadd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53465e7fdf8a36c0905ff909d12aadd7">&#9670;&nbsp;</a></span>thermodynamics_calculate_drag_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_calculate_drag_quantities </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pvecback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate various quantities at the time of ending of baryon drag (It is precisely where tau_d crosses one)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input/Output: pointer to initialized thermodynamics structure </td></tr>
    <tr><td class="paramname">pvecback</td><td>Input: pointer to some allocated pvecback </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>
<ul>
<li>find baryon drag time (when tau_d crosses one, using linear interpolation) and sound horizon at that time</li>
</ul>

</div>
</div>
<a id="afb4a2cb09339ac0068c732bb56672bfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb4a2cb09339ac0068c732bb56672bfb">&#9670;&nbsp;</a></span>thermodynamics_ionization_fractions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_ionization_fractions </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>current_ap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute ionization fractions with the RecFast of HyRec algorithm.</p>
<p>Compute ionization fractions using either the vector y or, in some approximation schemes, some analytic approximations. The output of this function is located in the ptw-&gt;ptdw workspace. We need to assign:</p>
<ul>
<li>in the RecFast scheme only: &ndash; ptdw-&gt;x_H, ptdw-&gt; x_He (all neglecting reionisation, which is accounted for later on);</li>
<li>in both schemes: &ndash; ptdw-&gt;x_noreio (neglecting reionisation); &ndash; ptdw-&gt;x_reio (if reionisation is going on; obtained by calling <a class="el" href="thermodynamics_8c.html#ae7cede4f50dd5d833a11be70890ae07d">thermodynamics_reionization_function()</a> and adding something to ptdw-&gt;x_noreio)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">y</td><td>Input: vector of quantities to integrate with evolver </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to thermodynamics structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ptw</td><td>Input/Output: pointer to thermo workspace. Contains output for x, ... </td></tr>
    <tr><td class="paramname">current_ap</td><td>Input: index of current approximation scheme </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>
<ul>
<li>Calculate x_noreio from Recfast/Hyrec in each approximation regime. Store the results in the workspace.</li>
<li>--&gt; For credits, see external/wrap_recfast.c</li>
<li>--&gt; first regime: H and Helium fully ionized</li>
<li>--&gt; second regime: first Helium recombination (analytic approximation)</li>
<li>--&gt; third regime: first Helium recombination finished, H and Helium fully ionized</li>
<li>--&gt; fourth regime: second Helium recombination starts (analytic approximation)</li>
<li>--&gt; fifth regime: Hydrogen recombination starts (analytic approximation) while Helium recombination continues (full equation)</li>
<li>--&gt; sixth regime: full Hydrogen and Helium equations</li>
<li>--&gt; seventh regime: calculate x_noreio during reionization (i.e. x before taking reionisation into account)</li>
<li>If z is during reionization, also calculate the reionized x</li>
</ul>

</div>
</div>
<a id="ae7cede4f50dd5d833a11be70890ae07d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7cede4f50dd5d833a11be70890ae07d">&#9670;&nbsp;</a></span>thermodynamics_reionization_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_reionization_function </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__reionization__parameters">thermo_reionization_parameters</a> *&#160;</td>
          <td class="paramname"><em>preio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This subroutine contains the reionization function <img class="formulaInl" alt="$ X_e(z) $" src="form_297.png"/> (one for each scheme) and gives x for a given z.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to thermodynamics structure, to know which scheme is used </td></tr>
    <tr><td class="paramname">preio</td><td>Input: pointer to reionization parameters of the function <img class="formulaInl" alt="$ X_e(z) $" src="form_297.png"/> </td></tr>
    <tr><td class="paramname">x</td><td>Output: <img class="formulaInl" alt="$ X_e(z) $" src="form_297.png"/> </td></tr>
  </table>
  </dd>
</dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>no reionization means nothing to be added to xe_before</li>
<li>implementation of ionization function similar to the one in CAMB</li>
<li>--&gt; case z &gt; z_reio_start</li>
<li>--&gt; case z &lt; z_reio_start: hydrogen contribution (tanh of complicated argument)</li>
<li>--&gt; case z &lt; z_reio_start: helium contribution (tanh of simpler argument)</li>
<li>implementation of half-tangent like in 1209.0247</li>
<li>--&gt; case z &gt; z_reio_start</li>
<li>--&gt; case z &lt; z_reio_start: hydrogen contribution (tanh of complicated argument)</li>
<li>implementation of binned ionization function similar to astro-ph/0606552</li>
<li>--&gt; case z &gt; z_reio_start</li>
<li>implementation of many tanh jumps</li>
<li>--&gt; case z &gt; z_reio_start</li>
<li>implementation of reio_inter</li>
<li>--&gt; case z &gt; z_reio_start</li>
</ul>

</div>
</div>
<a id="a4b34f6155bde89a84c0390c2fc61f8ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b34f6155bde89a84c0390c2fc61f8ea">&#9670;&nbsp;</a></span>thermodynamics_output_titles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_output_titles </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>titles</em>[_MAXTITLESTRINGLENGTH_]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function for formatting the titles to be output</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to the thermodynamics structure </td></tr>
    <tr><td class="paramname">titles</td><td>Input: titles string containing all titles </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a76d7488aed4246518d57574d8b6da687"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76d7488aed4246518d57574d8b6da687">&#9670;&nbsp;</a></span>thermodynamics_output_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_output_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>number_of_titles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output the data for the output into files</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to the thermodynamics structure </td></tr>
    <tr><td class="paramname">number_of_titles</td><td>Input: number of titles </td></tr>
    <tr><td class="paramname">data</td><td>Input: pointer to data file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a593f1de8b76eec15471b9a9622979a14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a593f1de8b76eec15471b9a9622979a14">&#9670;&nbsp;</a></span>thermodynamics_idm_quantities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_idm_quantities </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pvecback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes the quantities connected to interacting dark matter with photons, baryons &amp; dark radiation (idm), and interacting dark radiation (idr)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">y</td><td>Input: vector of evolver quantities </td></tr>
    <tr><td class="paramname">dy</td><td>Input: derivative of this vector </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to thermodynamics structure </td></tr>
    <tr><td class="paramname">ptw</td><td>Input/Output: pointer to thermo workspace </td></tr>
    <tr><td class="paramname">pvecback</td><td>Input: vector of background quantities</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<p>Define local variables</p>
<ul>
<li>First deal with any required dark radiation</li>
<li>Now deal with any required dark matter (and its interactions)</li>
</ul>

</div>
</div>
<a id="ad37daacbb0770350d2de9ef09e8732bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad37daacbb0770350d2de9ef09e8732bc">&#9670;&nbsp;</a></span>thermodynamics_obtain_z_ini()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_obtain_z_ini </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__workspace">thermo_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if the initial integration time and spacing needs adjusting, for example for interacting dark matter</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to thermo structure </td></tr>
    <tr><td class="paramname">ptw</td><td>Input/Output: pointer to thermo workspace </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="aacc44fb1fee6d4f38add0ec049664b4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc44fb1fee6d4f38add0ec049664b4b">&#9670;&nbsp;</a></span>thermodynamics_idm_initial_temperature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thermodynamics_idm_initial_temperature </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbackground.html">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z_ini</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo__diffeq__workspace">thermo_diffeq_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptdw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the correct initial temperature for the idm species</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to thermo structure </td></tr>
    <tr><td class="paramname">z_ini</td><td>Input: z_ini </td></tr>
    <tr><td class="paramname">ptdw</td><td>Input/Output: pointer to thermo differential equation workspace </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<ul>
<li>define local parameters</li>
<li>obtain necessary background information</li>
</ul>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="thermodynamics_8c.html">thermodynamics.c</a></li>
    <li class="footer">Generated on Mon Feb 17 2025 10:44:54 for CLASS MANUAL by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
